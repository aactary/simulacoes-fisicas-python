{% extends 'big_one/page.html' %}

{% load static %}

{% block title %}
    PIBID | Simulações Físicas
{% endblock %}

{% block style %}
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<style>
    .simulacao-section {
        padding: 60px 0;
    }
    .grafico-box {
        background-color: #f8f9fa;
        border: 1px solid #dee2e6;
        padding: 20px;
        min-height: 300px;
        text-align: center;
    }
</style>
{% endblock %}

{% block content %}

<!-- Seção principal -->
<section class="simulacao-section">
    <div class="container">
        <h2 class="mb-4 text-center">{{ titulo_simulacao|default:"Simulação - Lançamento de Projéteis" }}</h2>

        <div class="row">
            <!-- Formulário -->
            <div class="col-md-4">
                <div class="card shadow-sm mb-4">
                    <div class="card-body">
                        <h5 class="card-title">Insira os parâmetros</h5>
                        <form method="get">
                            {% csrf_token %}
            
                            <div class="mb-3">
                                <label for="velocidade" class="form-label">Velocidade (m/s)</label>
                                <input type="number" name="velocidade" step="0.1" value="{{ velocidade }}"
                                       class="form-control" id="velocidade">
                            </div>
            
                            <div class="mb-3">
                                <label for="angulo" class="form-label">Ângulo (graus)</label>
                                <input type="number" name="angulo" step="1" value="{{ angulo }}"
                                       class="form-control" id="angulo">
                            </div>
            
                            <div class="mb-3">
                                <label for="gravidade" class="form-label">Gravidade (m/s²)</label>
                                <input type="number" name="gravidade" step="0.1" value="{{ gravidade }}"
                                       class="form-control" id="gravidade">
                            </div>
            
                            <hr>
            
                            <button type="button" onclick="geraGraficoSimulacao()" class="btn btn-success">
                                Simular Lançamento <i class="bi bi-rocket-takeoff-fill"></i>
                            </button>
                        </form>
                    </div>
                </div>
            </div>
            

            <!-- Área da Simulação/Gráfico -->
            <div class="col-md-8">
                <div class="grafico-box">
                    <div class="row">
                        <div class="col-md mb-3">
                            <label for="altura-maxima" class="form-label">Altura Máxima</label>
                            <input type="text" class="form-control text-danger" id="altura-maxima"
                                   value="{{ altura_maxima }}m" readonly>
                        </div>
                        <div class="col-md mb-3">
                            <label for="alcance" class="form-label">Distância Total</label>
                            <input type="text" class="form-control text-danger" id="alcance"
                                   value="{{ alcance }}m" readonly>
                        </div>
                        <div class="col-md mb-3">
                            <label for="tempo_total" class="form-label">Tempo Total</label>
                            <input type="text" class="form-control text-danger" id="tempo_total"
                                   value="{{ tempo_total }}s" readonly>
                        </div>
                    </div>
                    
                    <div class="text-center mt-4">
                        <img id="imagem_grafico" src="data:image/png;base64,{{ imagem_grafico }}"
                             alt="Trajetória do Projétil" class="img-fluid border rounded">
                    </div>
                    
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md mt-2">
                <div class="card shadow-sm">
                    <div class="card-header bg-light border-bottom">
                        <ul class="nav nav-tabs card-header-tabs" id="simulacaoTabs" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="formulas-tab" data-bs-toggle="tab" data-bs-target="#formulas"
                                    type="button" role="tab" aria-controls="formulas" aria-selected="true">Fórmulas</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="roteiro-tab" data-bs-toggle="tab" data-bs-target="#roteiro"
                                    type="button" role="tab" aria-controls="roteiro" aria-selected="false">
                                    Sugestão: Roteiro de Aula
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="codigo-tab" data-bs-toggle="tab" data-bs-target="#codigo"
                                    type="button" role="tab" aria-controls="codigo" aria-selected="false">Código Fonte</button>
                            </li>
                        </ul>
                    </div>
                    <div class="card-body">
                        <div class="tab-content" id="simulacaoTabsContent">
                            <!-- Fórmulas -->
                            <div class="tab-pane fade show active" id="formulas" role="tabpanel" aria-labelledby="formulas-tab">
                                <h5>Fórmulas do Lançamento de Projétil</h5>
                                <p>Altura máxima (\( h_{\text{max}} \)):</p>
                                \[
                                h_{\text{max}} = \frac{v_0^2 \sin^2(\theta)}{2g}
                                \]
        
                                <p>Alcance (\( R \)):</p>
                                \[
                                R = \frac{v_0^2 \sin(2\theta)}{g}
                                \]
        
                                <p>Tempo total de voo (\( T \)):</p>
                                \[
                                T = \frac{2v_0 \sin(\theta)}{g}
                                \]
                            </div>
        
                            <!-- Roteiro de Aula -->
                            <div class="tab-pane fade" id="roteiro" role="tabpanel" aria-labelledby="roteiro-tab">
                                <h4><i class="bi bi-pin-angle-fill"></i> ROTEIRO DE AULA: Simulação Computacional de Lançamento de Projéteis</h4>
        
                                <ul>
                                    <li><strong>Série:</strong> 2ª ou 3ª série do Ensino Médio</li>
                                    <li><strong>Duração:</strong> 2 aulas (50 minutos cada)</li>
                                    <li><strong>Área:</strong> Ciências da Natureza e suas Tecnologias</li>
                                    <li><strong>Disciplina:</strong> Física</li>
                                </ul>
        
                                <h5>1. Tema da Aula:</h5>
                                <p>Simulação Computacional de Lançamento de Projéteis: analisando altura e distância máxima.</p>
        
                                <h5>2. Objetivos de Aprendizagem:</h5>
                                <ul>
                                    <li>Compreender o movimento de projéteis sob ação da gravidade.</li>
                                    <li>Aplicar equações da cinemática em duas dimensões.</li>
                                    <li>Interpretar graficamente os resultados da simulação.</li>
                                    <li>Desenvolver habilidades de resolução de problemas com uso de tecnologia.</li>
                                </ul>
        
                                <h5>3. Habilidades da BNCC (Ciências da Natureza):</h5>
                                <ul>
                                    <li>EM13CNT102 – Analisar e/ou simular o movimento de objetos com base em leis e princípios da mecânica clássica.</li>
                                    <li>EM13CNT103 – Resolver problemas com ou sem uso de tecnologias digitais, envolvendo movimentos de corpos.</li>
                                    <li>EM13CNT104 – Investigar e analisar movimentos utilizando linguagens matemáticas e computacionais.</li>
                                    <li>EM13CNT301 – Utilizar ferramentas computacionais para modelar situações-problema e interpretar dados.</li>
                                </ul>
        
                                <h5>4. Conteúdos Abordados:</h5>
                                <ul>
                                    <li>Movimento oblíquo (2D)</li>
                                    <li>Componentes horizontal e vertical da velocidade</li>
                                    <li>Equações da cinemática</li>
                                </ul>
        
                                <h5>5. Metodologia:</h5>
                                <h6>Aula 1: Contextualização e Fundamentos</h6>
                                <ul>
                                    <li>Introdução ao movimento de projéteis: exemplos do cotidiano.</li>
                                    <li>Apresentação das equações da cinemática em duas dimensões.</li>
                                    <li>Discussão: o que é simulação? Por que simular um fenômeno físico?</li>
                                    <li>Alunos, em duplas, ajustam parâmetros e observam resultados.</li>
                                </ul>
        
                                <h6>Aula 2: Exploração, Interpretação e Avaliação</h6>
                                <ul>
                                    <li>Execução da simulação com diferentes valores.</li>
                                    <li>Análise de gráficos: altura x tempo, distância x tempo, trajetória.</li>
                                    <li>Discussão em grupo: como a simulação se aproxima da realidade?</li>
                                    <li>Desafios (ex: "Qual ângulo dá maior alcance?")</li>
                                    <li>Reflexão sobre o uso da programação como ferramenta científica.</li>
                                </ul>
        
                                <h5>6. Recursos Didáticos:</h5>
                                <ul>
                                    <li>Computadores com acesso à internet</li>
                                    <li>Projetor multimídia</li>
                                    <li>Quadro branco</li>
                                    <li>Simulação Computacional</li>
                                </ul>
        
                                <h5>7. Avaliação:</h5>
                                <ul>
                                    <li>Participação e discussões.</li>
                                    <li>Resolução de problema prático ao final.</li>
                                    <li>Entrega de relatório contendo:</li>
                                    <ul>
                                        <li>Print da simulação</li>
                                        <li>Análise dos resultados</li>
                                        <li>Reflexão do aprendizado</li>
                                    </ul>
                                </ul>
                            </div>
        
                            <!-- Código Fonte -->
                            <div class="tab-pane fade" id="codigo" role="tabpanel" aria-labelledby="codigo-tab">
                                <h5>Google Colab Notebook</h5>
                                <p>Acesse o código-fonte clicando no link abaixo:</p>
        
                                <a href="https://colab.research.google.com/drive/1hsV5OYdVdiFAHwrswDkR1uUm19UBdVAI?usp=sharing"
                                    target="_blank" rel="noopener">
                                    <img src="https://colab.research.google.com/assets/colab-badge.svg"
                                        alt="Abrir no Google Colab" />
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
    </div>
</section>

{% endblock %}

{% block script %}
<script src="https://code.jquery.com/jquery-3.6.4.min.js"
    integrity="sha256-oP6HI9z1XaZNBrJURtCoUT5SUnxFr8s3BzRl+cbzUq8=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/selectize.js/0.15.2/js/selectize.min.js"
    integrity="sha512-IOebNkvA/HZjMM7MxL0NYeLYEalloZ8ckak+NDtOViP7oiYzG5vn6WVXyrJDiJPhl4yRdmNAG49iuLmhkUdVsQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer">
    </script>
<script>
    //var selectLeague = $('#escola').selectize();
    //var selectSeason = $('#aplicador').selectize();

    function showOverLay() {
        const overlays = document.querySelectorAll('.overlay')

        overlays.forEach(function (overlay) {
            overlay.classList.remove('d-none')
        })
    }

    function hideOverLay() {
        const overlays = document.querySelectorAll('.overlay')

        overlays.forEach(function (overlay) {
            overlay.classList.add('d-none')
        })
    }

    async function geraGraficoSimulacao() {
        showOverLay()
        try {
            let query_params = '?velocidade=' + document.querySelector('#velocidade').value + '&angulo=' +
                document.querySelector('#angulo').value + '&gravidade=' +
                document.querySelector('#gravidade').value
            const request = await fetch("http://127.0.0.1:8000/api/lancamento-projetil/" + query_params)
            const response = await request.json()
            console.log(response)
            // 
            const grafico = document.querySelector('#imagem_grafico')
            grafico.src = "data:image/png;base64, " + response.imagem_grafico
            document.querySelector('#altura-maxima').value = response.altura_maxima + 'm'
            document.querySelector('#alcance').value = response.alcance + 'm'
            document.querySelector('#tempo_total').value = response.tempo_total + 's'
        } catch (error) {
            console.log(error)
        }
        hideOverLay()
    }

</script>

{% endblock %}